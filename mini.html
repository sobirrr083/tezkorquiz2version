<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tizimga kirish</title>
  <meta name="description" content="Tezkor Quiz tizimiga kirish. Online testlar, quizlar va imtihon tayyorlov uchun shaxsiy kabinetga kirish sahifasi.">

   <link rel="icon" href="aga/iconcha.png">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}
    body{font-family:'Poppins',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;background:#fff;min-height:100vh;position:relative;overflow-x:hidden}
    body::before{content:'';position:fixed;inset:0;background:#fff;background-image:radial-gradient(circle at top left,rgba(70,130,180,.3),transparent 70%);filter:blur(80px);z-index:0;pointer-events:none}
    .main-wrapper{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px;position:relative;z-index:1}
    .container{background:rgba(255,255,255,.98);backdrop-filter:blur(10px);border-radius:20px;box-shadow:0 8px 32px rgba(67,97,238,.08);padding:40px;width:100%;max-width:420px;animation:slideUp .5s ease;border:1px solid rgba(67,97,238,.05)}
    @keyframes slideUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
    .page{display:none}
    .page.active{display:block;animation:fadeIn .4s ease}
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}
    .logo{text-align:center;margin-bottom:30px}
    .logo-icon{width:64px;height:64px;background:linear-gradient(135deg,#4361ee,#3651d4);border-radius:16px;display:inline-flex;align-items:center;justify-content:center;font-size:32px;margin-bottom:12px;box-shadow:0 8px 24px rgba(67,97,238,.2);overflow:hidden}
    .logo-icon img{width:100%;height:100%;object-fit:cover}
    h2{color:#1a1a2e;margin-bottom:8px;text-align:center;font-size:28px;font-weight:500}
    .subtitle,.description{text-align:center;color:#666;margin-bottom:35px;font-size:14px;line-height:1.5;font-weight:400}
    .description{margin-bottom:30px}
    .input-group{margin-bottom:20px;position:relative}
    .input-group label{display:block;margin-bottom:8px;color:#333;font-size:14px;font-weight:500}
    input{width:100%;padding:12px 16px;border:1px solid #e1e8ed;border-radius:10px;font-size:15px;transition:all .3s;outline:none;background:#fff;font-weight:400}
    input:focus{border-color:#4361ee;box-shadow:0 0 0 3px rgba(67,97,238,.08)}
    input.error{border-color:#ff4757}
    /* KO'Z ICONKASI */
    .eye-toggle{position:absolute;right:12px;top:42px;cursor:pointer;color:#888;transition:color .2s;z-index:2}
    .eye-toggle:hover{color:#4361ee}
    .eye-toggle svg{width:20px;height:20px}
    .btn{width:100%;padding:14px;border:none;border-radius:10px;font-size:15px;font-weight:500;cursor:pointer;transition:all .3s;margin-bottom:12px;position:relative;display:flex;align-items:center;justify-content:center;gap:8px}
    .btn:disabled{opacity:.6;cursor:not-allowed;pointer-events:none}
    .btn-primary{background:#4361ee;color:#fff}
    .btn-primary:hover:not(:disabled){background:#3651d4;transform:translateY(-1px);box-shadow:0 8px 20px rgba(67,97,238,.2)}
    .btn-secondary{background:#fff;border:1px solid #e1e8ed;color:#333}
    .btn-secondary:hover:not(:disabled){background:#f8f9fa;border-color:#4361ee}
    .btn-google{background:#fff;border:1px solid #e1e8ed;color:#444}
    .btn-google:hover:not(:disabled){background:#f8f9fa;border-color:#4361ee}
    .btn-google:disabled{opacity:.55;background:#f8f9fa !important;border-color:#e1e8ed !important;color:#999 !important;cursor:not-allowed}
    .btn-help{background:transparent;border:1px solid #4361ee;color:#4361ee;padding:10px 20px;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .3s;display:inline-flex;align-items:center;gap:6px;width:auto}
    .btn-help:hover{background:#4361ee;color:#fff;transform:translateY(-1px)}
    .google-icon{width:20px;height:20px}
    .divider{display:flex;align-items:center;margin:25px 0;color:#999;font-size:14px;font-weight:400}
    .divider::before,.divider::after{content:'';flex:1;border-bottom:1px solid #e1e8ed}
    .divider::before{margin-right:10px}
    .divider::after{margin-left:10px}
    .links{text-align:center;margin-top:25px;font-size:14px;color:#666;font-weight:400}
    .links a{color:#4361ee;text-decoration:none;font-weight:500;cursor:pointer}
    .links a:hover{text-decoration:underline}
    .forgot-password{text-align:right;margin-bottom:20px}
    .forgot-password a{color:#4361ee;text-decoration:none;font-size:14px;font-weight:400;cursor:pointer}
    .forgot-password a:hover{text-decoration:underline}
    .icon{text-align:center;margin-bottom:20px;font-size:48px}
    .icon img{width:500px;height:500px;object-fit:contain;max-width:100%;height:auto}
    /* Reset page uchun maxsus icon stillari - ixcham va chiroyli, shadow'siz */
    #resetPage .icon {margin-bottom: 15px;}
    #resetPage .icon img {width: 80px; height: 80px; max-width: 80px; max-height: 80px; object-fit: contain;}
    .alert{padding:12px 16px;border-radius:8px;margin-bottom:20px;font-size:14px;display:none;animation:slideDown .3s ease;font-weight:400}
    @keyframes slideDown{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}
    .alert.show{display:block}
    .alert-error{background:#fee;color:#c33;border:1px solid #fcc}
    .alert-success{background:#e8f5e9;color:#2e7d32;border:1px solid #c8e6c9}
    .alert-info{background:#e3f2fd;color:#1565c0;border:1px solid #bbdefb}
    .spinner{display:none;width:18px;height:18px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:spin .8s linear infinite;position:absolute;right:16px;top:50%;transform:translateY(-50%)}
    @keyframes spin{to{transform:translateY(-50%) rotate(360deg)}}
    .btn.loading .spinner{display:block}
    .btn.loading .btn-text{opacity:.7}
    .checkbox-group{margin:20px 0;display:flex;align-items:flex-start;gap:10px}
    .checkbox-group input[type=checkbox]{width:18px;height:18px;cursor:pointer;margin-top:2px;flex-shrink:0;accent-color:#4361ee}
    .checkbox-group label{font-size:13px;color:#555;line-height:1.5;cursor:pointer;user-select:none;font-weight:400}
    .checkbox-group label a{color:#4361ee;text-decoration:none;font-weight:500}
    .checkbox-group label a:hover{text-decoration:underline}
    .password-strength{margin-top:8px;height:3px;background:#e1e8ed;border-radius:2px;overflow:hidden;transition:all .3s}
    .password-strength-bar{height:100%;width:0;transition:all .3s;border-radius:2px}
    .password-strength-text{font-size:12px;margin-top:6px;font-weight:500;transition:all .3s}
    .strength-weak .password-strength-bar{width:33%;background:#ff4757}
    .strength-weak .password-strength-text{color:#ff4757}
    .strength-good .password-strength-bar{width:66%;background:#ffa502}
    .strength-good .password-strength-text{color:#ffa502}
    .strength-strong .password-strength-bar{width:100%;background:#26de81}
    .strength-strong .password-strength-text{color:#26de81}
    .password-requirements{display:none;margin-top:10px}
    .password-requirements .req{font-size:12px;color:#888;margin-bottom:4px;line-height:1.3;transition:color .3s}
    .password-requirements .req.met{color:#26de81}
    .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.4);backdrop-filter:blur(4px);z-index:1000;align-items:center;justify-content:center;padding:20px;animation:fadeIn .3s ease}
    .modal.show{display:flex}
    .modal-content{background:#fff;border-radius:16px;padding:28px;max-width:480px;width:100%;max-height:80vh;overflow-y:auto;animation:modalSlideUp .3s ease;box-shadow:0 12px 40px rgba(0,0,0,.15)}
    @keyframes modalSlideUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
    .modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;position:sticky;top:0;background:#fff;z-index:10;padding-bottom:10px}
    .modal-header h3{color:#1a1a2e;font-size:22px;font-weight:500}
    .modal-close{background:#f8f9fa;border:none;width:30px;height:30px;border-radius:50%;cursor:pointer;font-size:18px;line-height:1;transition:all .3s;flex-shrink:0}
    .modal-close:hover{background:#e9ecef;transform:rotate(90deg)}
    .modal-body{color:#555;line-height:1.6;font-size:14px;font-weight:400}
    .modal-body h4{color:#1a1a2e;margin-top:20px;margin-bottom:10px;font-size:16px;font-weight:500}
    .modal-body p{margin-bottom:15px}
    .contact-links{display:flex;gap:12px;margin-top:20px;flex-wrap:wrap}
    .contact-link{flex:1;min-width:130px;display:flex;align-items:center;justify-content:center;gap:8px;padding:12px 16px;background:#fff;border:1px solid #e1e8ed;border-radius:10px;text-decoration:none;color:#333;font-weight:500;font-size:14px;transition:all .3s}
    .contact-link:hover{border-color:#4361ee;background:#f8f9fa;transform:translateY(-1px)}
    .contact-link.telegram{border-color:#0088cc;color:#0088cc}
    .contact-link.telegram:hover{background:#e8f5fa}
    .contact-link.email{border-color:#4361ee;color:#4361ee}
    .contact-link.email:hover{background:#e8ecfb}
    .copy-notification{position:fixed;top:20px;right:20px;background:#ff4757;color:#fff;padding:12px 16px;border-radius:8px;font-weight:500;font-size:14px;box-shadow:0 8px 24px rgba(255,71,87,.2);z-index:10000;animation:slideInRight .3s ease;display:none}
    .copy-notification.show{display:block}
    @keyframes slideInRight{from{opacity:0;transform:translateX(100px)}to{opacity:1;transform:translateX(0)}}
    .countdown{font-size:14px;color:#2e7d32;margin-top:10px;text-align:center}
    .back-to-login{margin-top:15px}
  </style>
</head>
<body>
  <div class="copy-notification" id="copyNotification">
    www.tezkorquiz.uz saytida parolni nusxalash mumkin emas
  </div>

  <div class="main-wrapper">
    <div class="container">
      <!-- Welcome Page -->
      <div id="welcomePage" class="page active">
        <div class="logo"><div class="logo-icon"><img src="aga/milliylogo.webp" alt="Logo" id="mainLogo"></div></div>
        <h2>Xush kelibsiz!</h2>
        <p class="subtitle">Davom etish uchun kirish usulini tanlang</p>
        <div id="welcomeAlert" class="alert"></div>

        <button class="btn btn-secondary" onclick="showPage('emailLoginPage')">Email orqali kirish</button>
        <button class="btn btn-primary" onclick="showPage('signupPage')">Ro'yxatdan o'tish</button>

        <div class="divider">yoki</div>

        <button id="welcomeGoogle" class="btn btn-google" disabled>
          <svg class="google-icon" viewBox="0 0 24 24">
            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
          </svg>
          <span class="btn-text">Google orqali kirish</span>
          <div class="spinner"></div>
        </button>

        <div class="links" style="margin-top:30px;">
          <button type="button" class="btn-help" onclick="showModal('helpModal')">Yordam kerakmi?</button>
        </div>
      </div>

      <!-- Email Login Page -->
      <div id="emailLoginPage" class="page">
        <h2>Email bilan kirish</h2>
        <p class="subtitle">Hisobingizga kirish uchun email va parolni kiriting</p>
        <div id="loginAlert" class="alert"></div>
        <form id="loginForm">
          <div class="input-group">
            <label>Email</label>
            <input type="email" id="loginEmail" placeholder="namuna@gmail.com" required autocomplete="off" oncopy="handleCopy(event)">
          </div>
          <div class="input-group">
            <label>Parol</label>
            <input type="password" id="loginPassword" placeholder="parolni kiriting" required autocomplete="off" oncopy="handleCopy(event)">
            <span class="eye-toggle" id="loginEye">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"/>
              </svg>
            </span>
          </div>
          <div class="forgot-password"><a onclick="showPage('resetPage')">Parolni unutdingizmi?</a></div>
          <button type="submit" class="btn btn-primary"><span class="btn-text">Kirish</span><div class="spinner"></div></button>
        </form>
        <div class="links">Hisobingiz yo'qmi? <a onclick="showPage('signupPage')">Ro'yxatdan o'tish</a></div>
      </div>

      <!-- Signup Page -->
      <div id="signupPage" class="page">
        <h2>Ro'yxatdan o'tish</h2>
        <p class="subtitle">Yangi hisob ochish uchun ma'lumotlarni to'ldiring</p>
        <div id="signupAlert" class="alert"></div>
        <form id="signupForm">
          <div class="input-group"><label>Ism</label><input type="text" id="signupName" placeholder="Ismingiz" required autocomplete="off" oncopy="handleCopy(event)"></div>
          <div class="input-group"><label>Email</label><input type="email" id="signupEmail" placeholder="namuna@gmail.com" required autocomplete="off" oncopy="handleCopy(event)"></div>
          <div class="input-group">
            <label>Parol yarating</label>
            <input type="password" id="signupPassword" placeholder="Kamida 8 ta belgi" required minlength="8" autocomplete="off" oncopy="handleCopy(event)">
            <span class="eye-toggle" id="signupEye">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"/>
              </svg>
            </span>
            <div class="password-strength"><div class="password-strength-bar"></div></div>
            <div class="password-strength-text"></div>
            <div class="password-requirements">
              <div class="req" id="req-length">• Kamida 8 ta belgi</div>
              <div class="req" id="req-number">• Kamida bitta raqam (0-9)</div>
              <div class="req" id="req-upper">• Kamida bitta katta harf (A-Z)</div>
              <div class="req" id="req-lower">• Kamida bitta kichik harf (a-z)</div>
              <div class="req" id="req-special">• Kamida bitta maxsus belgi (!@#$%^&*)</div>
            </div>
          </div>
          <div class="checkbox-group"><input type="checkbox" id="termsCheckbox" required>
            <label for="termsCheckbox">Men <a href="https://tezkorquiz.uz/terms_of_use" target="_blank">Foydalanish shartlari</a> va <a href="https://tezkorquiz.uz/privacy_policy" target="_blank">Maxfiylik siyosati</a> bilan tanishdim va roziman</label>
          </div>
          <button type="submit" class="btn btn-primary"><span class="btn-text">Ro'yxatdan o'tish</span><div class="spinner"></div></button>
        </form>
        <div class="divider">yoki</div>
        <button id="signupGoogle" class="btn btn-google" disabled>
          <svg class="google-icon" viewBox="0 0 24 24">
            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
          </svg>
          <span class="btn-text">Google orqali ro'yxatdan o'tish</span>
          <div class="spinner"></div>
        </button>
        <div class="links">Hisobingiz bormi? <a onclick="showPage('emailLoginPage')">Kirish</a></div>
      </div>

      <!-- Password Reset Page -->
      <div id="resetPage" class="page">
        <div class="icon"><img src="aga/lock.png" alt="Lock" id="lockIcon"></div>
        <h2>Parolni tiklash</h2>
        <p class="description">Email manzilingizni kiriting va biz sizga parolni tiklash uchun havola yuboramiz.</p>
        <div id="resetAlert" class="alert"></div>
        <form id="resetForm">
          <div class="input-group"><label>Email</label><input type="email" id="resetEmail" placeholder="namuna@email.com" required autocomplete="off" oncopy="handleCopy(event)"></div>
          <button type="submit" class="btn btn-primary"><span class="btn-text">Tiklash havolasini yuborish</span><div class="spinner"></div></button>
        </form>
        <div id="resetSuccess" style="display:none;text-align:center;margin-top:20px;">
          <p style="color:#2e7d32;font-weight:500;">Parolni tiklash havolasi <span id="sentEmail"></span> ga yuborildi.</p>
          <p class="countdown" id="countdown">Qayta urinish uchun <span id="seconds">60</span> soniya</p>
          <button class="btn btn-secondary back-to-login" onclick="showPage('emailLoginPage')">Kirish sahifasiga qaytish</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Help Modal -->
  <div id="helpModal" class="modal">
    <div class="modal-content">
      <div class="modal-header"><h3>Yordam</h3><button class="modal-close" onclick="closeModal('helpModal')">x</button></div>
      <div class="modal-body">
        <h4>Kirish muammolari</h4>
        <p><strong>Parolni unutdingizmi?</strong><br>"Email orqali kirish" tugmasini bosing va "Parolni unutdingizmi?" havolasiga o'ting. Email manzilingizga parolni tiklash havolasi yuboriladi.</p>
        <p><strong>Email yoki parol noto'g'ri?</strong><br>Email manzilingiz va parolingizni to'g'ri kiritganingizga ishonch hosil qiling. Caps Lock yoqilmaganligini tekshiring.</p>
        <h4>Google orqali kirish</h4>
        <p><strong>Eslatma:</strong> Google orqali kirish va ro'yxatdan o'tish vaqtincha o'chirilgan. Iltimos, email orqali foydalaning.</p>
        <h4>Texnik muammolar</h4>
        <p>Agar internet aloqangizda muammo bo'lsa, ulanishni tekshiring va qaytadan urinib ko'ring.</p>
        <h4>Biz bilan bog'lanish</h4>
        <p>Qo'shimcha yordam kerak bo'lsa, quyidagi orqali murojaat qilishingiz mumkin:</p>
        <div class="contact-links">
          <a href="https://t.me/sobirweb" target="_blank" class="contact-link telegram"><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4.64 6.8c-.15 1.58-.8 5.42-1.13 7.19-.14.75-.42 1-.68 1.03-.58.05-1.02-.38-1.58-.75-.88-.58-1.38-.94-2.23-1.5-.99-.65-.35-1.01.22-1.59.15-.15 2.71-2.48 2.76-2.69a.2.2 0 00-.05-.18c-.06-.05-.14-.03-.21-.02-.09.02-1.49.95-4.22 2.79-.4.27-.76.41-1.08.40-.36-.01-1.04-.20-1.55-.37-.63-.20-1.12-.31-1.08-.66.02-.18.27-.36.74-.55 2.92-1.27 4.86-2.11 5.83-2.51 2.78-1.16 3.35-1.36 3.73-1.36.08 0 .27.02.39.12.1.08.13.19.14.27-.01.06.01.24 0 .38z"/></svg>Telegram</a>
          <a href="https://mail.google.com/mail/?view=cm&fs=1&to=tezkorquiz@gmail.com&su=Tezkor%20Quiz%20bo%27yicha%20savol&body=Salom,%0D%0A%0D%0A" target="_blank" class="contact-link email"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>Email</a>
        </div>
      </div>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, sendPasswordResetEmail, updateProfile } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

    const firebaseConfig = {
      apiKey: "AIzaSyBxIpLY5WasiSIlDL4japBLnnXRwOLUKEQ",
      authDomain: "tezkor-quiz-bbe3c.firebaseapp.com",
      projectId: "tezkor-quiz-bbe3c",
      storageBucket: "tezkor-quiz-bbe3c.firebasestorage.app",
      messagingSenderId: "143161522496",
      appId: "1:143161522496:web:252108ace3a4c19f35e2a5",
    };

    let app, auth;
    try {
      app = initializeApp(firebaseConfig);
      auth = getAuth(app);
      console.log('Firebase muvaffaqiyatli ulandi');
    } catch (e) {
      console.error('Firebase ulanishda xatolik:', e);
      showAlert('welcomeAlert','Firebase ulanishida xatolik. Console ni tekshiring.','error');
    }

    /* ==== KO'Z ICONKASI - TO'G'IRLANGAN: TESKARI EMAS, OCHIQ/YOPIQ ALMASHTIRILGAN ==== */
    // Ochiq ko'z (ko'rish uchun)
    const eyeOpenSVG = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
    </svg>`;

    // Yopiq ko'z (yashirish uchun - slash bilan)
    const eyeClosedSVG = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"/>
    </svg>`;

    function togglePassword(inputId, eyeId) {
      const input = document.getElementById(inputId);
      const eye = document.getElementById(eyeId);
      // Boshida yopiq ko'z (yashirin holat)
      eye.innerHTML = eyeClosedSVG;
      eye.addEventListener('click', () => {
        if (input.type === 'password') {
          // Yashirilgan -> ko'rsatish: ochiq ko'z
          input.type = 'text';
          eye.innerHTML = eyeOpenSVG;
        } else {
          // Ko'rsatilgan -> yashirish: yopiq ko'z
          input.type = 'password';
          eye.innerHTML = eyeClosedSVG;
        }
      });
    }
    togglePassword('loginPassword', 'loginEye');
    togglePassword('signupPassword', 'signupEye');

    /* ==== COUNTDOWN ==== */
    let countdownInterval;
    function startCountdown() {
      let sec = 60;
      const secEl = document.getElementById('seconds');
      const successDiv = document.getElementById('resetSuccess');
      const form = document.getElementById('resetForm');
      form.style.display = 'none';
      successDiv.style.display = 'block';
      document.getElementById('sentEmail').textContent = document.getElementById('resetEmail').value;
      document.getElementById('lockIcon').src = 'aga/lock-loading.gif'; // GIF ga o'zgartirish

      countdownInterval = setInterval(() => {
        sec--;
        secEl.textContent = sec;
        if (sec <= 0) {
          clearInterval(countdownInterval);
          document.querySelector('#countdown').innerHTML = 'Endi qayta urinib koʻrishingiz mumkin';
          document.getElementById('lockIcon').src = 'aga/lock.png'; // Qaytadan rasmga
        }
      }, 1000);
    }

    /* ==== QOLGAN FUNKSIYALAR ==== */
    function getDynamicGreeting(){
      const g={timeBased:[{text:'Xayrli tong!',startHour:5,endHour:9},{text:'Nurli tong',startHour:5,endHour:9},{text:'Xayrli kun!',startHour:12,endHour:17},{text:'Xayrli kech!',startHour:18,endHour:24}],
               random:['Salom do‘stim!','Assalomu aleykum!','Marhamat kiring!','Harakatni boshlang!','Yaxshi kayfiyat!','Kirish vaqti','Yangi start!','Kirish oson','Tizim tayyor','Keling, kiraylik','Profilga qadam','Profilga qadam','Tezkor kirish','Salom mehmon!','Omadli boshlang!']};
      const h=new Date().getHours();
      const match=g.timeBased.filter(i=>h>=i.startHour&&h<i.endHour).map(i=>i.text);
      const all=[...match,...g.random];
      return all[Math.floor(Math.random()*all.length)];
    }
    function updateGreeting(){document.querySelector('#welcomePage h2').textContent=getDynamicGreeting()}
    document.addEventListener('DOMContentLoaded',updateGreeting);

    // Security
    document.addEventListener('keydown',e=>{if(e.key==='F12'||(e.ctrlKey&&e.shiftKey&&['I','J','C'].includes(e.key))||(e.ctrlKey&&e.key==='u')){e.preventDefault();return false}});
    document.addEventListener('contextmenu',e=>e.preventDefault());
    window.handleCopy=e=>{e.preventDefault();showCopyNotification()};
    ['copy','cut','paste','selectstart'].forEach(ev=>document.addEventListener(ev,e=>{if(e.target.tagName!=='INPUT'){e.preventDefault();if(['copy','cut'].includes(ev))showCopyNotification();return false}}));
    function showCopyNotification(){const n=document.getElementById('copyNotification');n.classList.add('show');setTimeout(()=>n.classList.remove('show'),3000)}

    // Page / Modal
    let currentPage='welcomePage',modalOpen=false;
    function updateHistory(p){currentPage=p;history.pushState({page:p},'','')}
    window.addEventListener('popstate',()=>{if(modalOpen){closeModal('helpModal');modalOpen=false}else if(currentPage!=='welcomePage')showPage('welcomePage')});
    window.showModal=id=>{document.getElementById(id).classList.add('show');modalOpen=true;history.pushState({modal:id},'','')};
    window.closeModal=id=>{document.getElementById(id).classList.remove('show');modalOpen=false;history.back()};
    document.querySelectorAll('.modal').forEach(m=>m.addEventListener('click',e=>{if(e.target===m)closeModal(m.id)}));
    window.showPage=id=>{
      document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
      document.getElementById(id).classList.add('active');
      document.querySelectorAll('.alert').forEach(a=>{a.classList.remove('show');a.innerHTML=''});
      updateHistory(id);
      if(id==='welcomePage') updateGreeting();
      clearInterval(countdownInterval);
      document.getElementById('resetSuccess').style.display='none';
      document.getElementById('resetForm').style.display='block';
      if (id === 'resetPage') {
        document.getElementById('lockIcon').src = 'aga/lock.png'; // Rasmga qaytarish
      }
    };

    // Password strength - Yangi versiya
    const pwInput = document.getElementById('signupPassword');
    const commonPasswords = ['123456', '12345678', 'password', 'qwerty', 'abc123', 'admin', 'letmein', 'welcome', 'monkey', '1234567890', 'password123', '111111', 'dragon', 'baseball', 'football', 'iloveyou'];
    
    function checkPasswordRequirements(p) {
      const lengthOk = p.length >= 8;
      const hasNumber = /\d/.test(p);
      const hasUpper = /[A-Z]/.test(p);
      const hasLower = /[a-z]/.test(p);
      const hasSpecial = /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(p);
      
      // Har birini tekshirish va class qo'shish
      document.getElementById('req-length').classList.toggle('met', lengthOk);
      document.getElementById('req-number').classList.toggle('met', hasNumber);
      document.getElementById('req-upper').classList.toggle('met', hasUpper);
      document.getElementById('req-lower').classList.toggle('met', hasLower);
      document.getElementById('req-special').classList.toggle('met', hasSpecial);
      
      const count = [lengthOk, hasNumber, hasUpper, hasLower, hasSpecial].filter(Boolean).length;
      const isCommon = commonPasswords.includes(p.toLowerCase());
      
      let level, text, className;
      if (isCommon || !lengthOk) {
        level = 'weak';
        text = 'Zaif parol (juda oddiy yoki qisqa)';
        className = 'strength-weak';
      } else if (count >= 3) {
        level = 'good';
        text = 'Yaxshi parol';
        className = 'strength-good';
      } else {
        level = 'weak';
        text = 'Zaif parol (ko\'proq shartlarni bajaring)';
        className = 'strength-weak';
      }
      if (count === 5 && !isCommon) {
        level = 'strong';
        text = 'Ajoyib parol';
        className = 'strength-strong';
      }
      
      // Progress bar va text yangilash
      const container = pwInput.parentElement.querySelector('.password-strength');
      const bar = container.querySelector('.password-strength-bar');
      const textEl = pwInput.parentElement.querySelector('.password-strength-text');
      container.className = `password-strength ${className}`;
      bar.style.width = level === 'strong' ? '100%' : level === 'good' ? '66%' : '33%';
      textEl.textContent = text;
      
      return { level, isStrong: level === 'strong' };
    }

    pwInput?.addEventListener('input', e => {
      const p = e.target.value;
      const reqs = e.target.parentElement.querySelector('.password-requirements');
      if (p.length === 0) {
        // Boshlang'ich holat
        reqs.style.display = 'none';
        document.querySelectorAll('.req').forEach(req => req.classList.remove('met'));
        const container = e.target.parentElement.querySelector('.password-strength');
        const bar = container.querySelector('.password-strength-bar');
        const textEl = e.target.parentElement.querySelector('.password-strength-text');
        container.className = 'password-strength';
        bar.style.width = '0%';
        textEl.textContent = '';
        return;
      }
      reqs.style.display = 'block';
      checkPasswordRequirements(p);
    });

    // Alert / Loading
    function showAlert(id,msg,type='error'){const a=document.getElementById(id);a.innerHTML=msg;a.className=`alert alert-${type} show`;if(type==='success')setTimeout(()=>a.classList.remove('show'),5000)}
    function setLoading(btn,load){if(load){btn.disabled=true;btn.classList.add('loading')}else{btn.disabled=false;btn.classList.remove('loading')}}
    function clearForm(id){const f=document.getElementById(id);if(f){f.reset();const s=f.querySelector('.password-strength'),t=f.querySelector('.password-strength-text');if(s)s.className='password-strength';if(t)t.textContent=''; document.querySelectorAll('.req').forEach(req => req.classList.remove('met'));}};

    function getErrorMessage(c){const m={'auth/invalid-email':'Noto\'g\'ri email format','auth/user-disabled':'Bu foydalanuvchi o\'chirilgan','auth/user-not-found':'Bunday foydalanuvchi topilmadi','auth/wrong-password':'Noto\'g\'ri parol kiritildi','auth/email-already-in-use':'Bu email allaqachon ro\'yxatdan o\'tgan','auth/weak-password':'Parol juda oddiy. Kamida 8 ta belgi kiriting','auth/network-request-failed':'Internet aloqasi yo\'q. Iltimos, ulanishni tekshiring','auth/too-many-requests':'Juda ko\'p urinish. Iltimos, biroz kutib qaytadan urinib ko\'ring','auth/invalid-credential':'Noto\'g\'ri email yoki parol','auth/missing-password':'Parol kiritilmagan'};return m[c]||`Xatolik: ${c}`}

    // Forms
    document.getElementById('loginForm').addEventListener('submit',async e=>{e.preventDefault();const b=e.target.querySelector('.btn-primary'),em=document.getElementById('loginEmail').value,pw=document.getElementById('loginPassword').value;setLoading(b,true);try{await signInWithEmailAndPassword(auth,em,pw);showAlert('loginAlert','Muvaffaqiyatli kirildi!','success');clearForm('loginForm');setTimeout(()=>location.href='index.html',1500)}catch(err){showAlert('loginAlert',getErrorMessage(err.code),'error');setLoading(b,false)}});

    document.getElementById('signupForm').addEventListener('submit',async e=>{
      e.preventDefault();
      const b = e.target.querySelector('.btn-primary');
      const name = document.getElementById('signupName').value;
      const em = document.getElementById('signupEmail').value;
      const pw = document.getElementById('signupPassword').value;
      const terms = document.getElementById('termsCheckbox').checked;
      if (!terms) {
        showAlert('signupAlert','Iltimos, foydalanish shartlari bilan rozilik bildiring','error');
        return;
      }
      const pwCheck = checkPasswordRequirements(pw);
      if (pwCheck.level === 'weak') {
        showAlert('signupAlert','Parol juda zaif. Iltimos, kuchliroq parol yarating (kamida 3 ta shartni bajaring va oddiy parollardan qoching)','error');
        return;
      }
      setLoading(b,true);
      try{
        const uc=await createUserWithEmailAndPassword(auth,em,pw);
        await updateProfile(uc.user,{displayName:name});
        showAlert('signupAlert','Muvaffaqiyatli ro\'yxatdan o\'tdingiz!','success');
        clearForm('signupForm');
        setTimeout(()=>location.href='index.html',1500)
      }catch(err){
        showAlert('signupAlert',getErrorMessage(err.code),'error');
        setLoading(b,false)
      }
    });

    document.getElementById('resetForm').addEventListener('submit',async e=>{
      e.preventDefault();
      const b=e.target.querySelector('.btn-primary'),em=document.getElementById('resetEmail').value;
      setLoading(b,true);
      try{
        await sendPasswordResetEmail(auth,em);
        showAlert('resetAlert','Havola muvaffaqiyatli yuborildi!','success');
        startCountdown();
        setLoading(b,false);
      }catch(err){
        showAlert('resetAlert',err.code==='auth/user-not-found'?'Bu email bilan ro\'yxatdan o\'tilmagan':getErrorMessage(err.code),'error');
        setLoading(b,false);
      }
    });

    auth.onAuthStateChanged(u=>{console.log(u?'Foydalanuvchi tizimda: '+u.email:'Foydalanuvchi tizimda emas')});
    history.replaceState({page:'welcomePage'},'','');
  </script>
</body>
</html>
